<group name="local.certutil_lolbas,windows,sysmon">

  <rule id="996001" level="5">
    <if_group>windows</if_group>
    <field name="win.system.eventID">^1$</field>

    <field name="win.eventdata.Image" type="pcre2">(?i)certutil\.exe$</field>

    <description>[LOLBAS] certutil.exe process execution</description>

    <mitre>
      <id>T1105</id>
      <id>T1140</id>
    </mitre>

    <group>lolbas.certutil.base</group>
  </rule>


  <rule id="996002" level="10">
    <if_sid>996001</if_sid>

    <field name="win.eventdata.CommandLine" type="pcre2">(?i)https?://</field>

    <description>[LOLBAS] certutil.exe used for remote download (URL in CommandLine)</description>

    <mitre>
      <id>T1105</id>
    </mitre>

    <group>lolbas.certutil.download</group>
  </rule>


  
  <rule id="996003" level="11">
    <if_sid>996001</if_sid>

    <field name="win.eventdata.CommandLine" type="pcre2">(?i)(/decode|-decode)</field>

    <description>[LOLBAS] certutil.exe used to decode data (/decode)</description>

    <mitre>
      <id>T1140</id>
    </mitre>

    <group>lolbas.certutil.decode</group>
  </rule>


  
  <rule id="996004" level="13">
    <if_group>windows</if_group>
    <field name="win.system.eventID">^1$</field>

    <field name="win.eventdata.Image" type="pcre2">(?i)certutil\.exe$</field>

    <field name="win.eventdata.CommandLine" type="pcre2">Public</field>

    <description>[LOLBAS] certutil.exe URL download to Users\Public directory</description>

    <mitre>
      <id>T1105</id>
      <id>T1140</id>
    </mitre>

    <group>lolbas.certutil.download.suspicious_path</group>
  </rule>




</group>
